chrome.runtime.onInstalled.addListener(()=>{chrome.storage.local.set({enabled:!0,stats:{analyzed:0,co2Saved:0,ecoChoices:0}})});chrome.runtime.onMessage.addListener((t,a,r)=>{if(t.action==="getSustainabilityData")return setTimeout(()=>{const e=n(t.productInfo);r(e)},500),!0});function n(t){const a={nike:{score:65,carbonFootprint:8.2,waterUsage:"High",recyclable:45},adidas:{score:78,carbonFootprint:6.1,waterUsage:"Medium",recyclable:67},patagonia:{score:92,carbonFootprint:2.3,waterUsage:"Low",recyclable:89},apple:{score:71,carbonFootprint:12.5,waterUsage:"Medium",recyclable:78},samsung:{score:68,carbonFootprint:14.2,waterUsage:"High",recyclable:56},default:{score:55,carbonFootprint:10.5,waterUsage:"Medium",recyclable:40}},r=t.name.toLowerCase();let e=a.default;for(const o in a)if(r.includes(o)){e=a[o];break}return{sustainabilityScore:e.score,carbonFootprint:e.carbonFootprint,waterUsage:e.waterUsage,recyclableContent:e.recyclable,certifications:e.score>80?["B-Corp","Fair Trade"]:e.score>60?["Fair Trade"]:[],alternatives:i(t,e.score)}}function i(t,a){return a>=85?[]:[{name:"EcoChoice Alternative",brand:"GreenBrand",score:Math.min(95,a+20),price:"$"+(Math.random()*50+20).toFixed(2),savings:Math.floor(Math.random()*30+10)+"% less COâ‚‚"},{name:"Sustainable Option",brand:"EarthFirst",score:Math.min(90,a+15),price:"$"+(Math.random()*40+25).toFixed(2),savings:Math.floor(Math.random()*25+15)+"% less water"}].slice(0,Math.floor(Math.random()*2)+1)}
